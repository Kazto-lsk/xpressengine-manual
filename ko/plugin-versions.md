# 플러그인 버전 관리

플러그인은 처음 설치될 때, 필요에 따라 플러그인에서 사용할 데이터베이스 테이블을 생성하거나, 설정을 저장하기도 하고, 필요한 파일을 미리 생성해 놓기도 합니다. 이런 작업들은 플러그인이 실행될 때마다 매번 필요한 작업이 아니라 처음 설치될 때 단 한번만 실행돼야 하는 작업입니다. 플러그인이 업데이트 되었을 경우에도 마찬가지입니다. 플러그인에 새로운 기능이 플러그인에 추가되었다면 데이터베이스 테이블을 변경해야 할 수도 있습니다.

이렇게 플러그인이 설치되고 업데이트될 때, 또는 플러그인이 삭제될 때 실행되어야 하는 코드는 `plugin.php` 파일의 플러그인 클래스에 작성하십시오.


## 초기 설치

플러그인 클래스는 설치와 관련된 두개의 메소드를 가지고 있습니다. `checkInstalled`와 `install` 메소드입니다.

```php
<?php
namespace MyPlugin;

use Xpressengine\Plugin\AbstractPlugin;
use Schema;

class Plugin extends AbstractPlugin
{
  public function checkInstalled($installedVersion = null)
  {
      // 플러그인이 설치된 상태인지 체크하는 코드를 작성합니다.
  }
  
  public function install()
  {
      // 플러그인이 설치될 때 필요한 코드를 작성합니다.
  }
  
}
```

`checkInstalled` 메소드는 플러그인이 활성화될 때마다 호출됩니다. 만약 이 메소드가 `true`를 반환하면 XE는 이 플러그인이 이미 XE에 설치된 상태로 간주하고 곧바로 플러그인을 활성화시킵니다. 반대로 이 메소드가 `false`를 반환하면 XE는 이 플러그인이 아직 XE에 설치가 안 된 상태라고 판단합니다.


만약 필요한 테이블이 생성되어 있는지 검사하고 싶다면 아래와 같이 작성하면 됩니다.

```php
public function checkInstalled($currentVersion = null)
{
    // 0.0.2
    return Schema::hasTable('table_name');
}
```




플러그인이 설치되지 않았다고 판단될 경우, XE는 `install` 메소드를 다시 호출합니다. `install` 메소드에 설치시 필요한 코드를 작성하십시오. 







자신이 만든 플러그인을 XE에 설치하여 사용하거나 배포한 이후에, 새로운 기능을 플러그인에 추가하거나 오류를 개선하기 위해 플러그인을 업데이트하는 경우는 빈번히 발생합니다.

간단한 오류를 수정하는 경우에는 소스코드를 변경하는 것만으로도 쉽게 업데이트를 할 수 있습니다. 하지만 새로운 기능을 추가하거나 구조를 변경하는 경우에는, 별도의 데이터베이스 테이블을 추가해야 할 수도 있습니다.